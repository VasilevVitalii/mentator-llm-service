<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome - Mentator LLM Service</title>
    <link rel="stylesheet" href="/static/css/common.css">
</head>
<body>
    <div id="app">
        <div class="banner">
            <div class="banner-title">
                <a href="/">MENTATOR-LLM-SERVICE, version {{ version }}</a>
            </div>
            <div class="banner-subtitle">welcome</div>
        </div>

        <div class="main-content">
            <!-- Service Pages Cards -->
            <div class="card-container">
                <a href="/doc" class="card">
                    <div class="card-title">documentation API</div>
                    <div class="card-description">
                        Swagger/OpenAPI documentation for all service endpoints
                    </div>
                </a>

                <a href="/stat" class="card">
                    <div class="card-title">statistics</div>
                    <div class="card-description">
                        Service statistics dashboard with loaded models and performance metrics
                    </div>
                </a>

                <a href="/chat" class="card">
                    <div class="card-title">chat</div>
                    <div class="card-description">
                        Interactive interface for sending prompts and receiving LLM responses
                    </div>
                </a>

                <a href="/log/core" class="card">
                    <div class="card-title">core logs</div>
                    <div class="card-description">
                        View service operation logs
                    </div>
                </a>

                <a href="/log/chat" class="card">
                    <div class="card-title">chat logs</div>
                    <div class="card-description">
                        View request and response logs
                    </div>
                </a>
            </div>

            <!-- Service Description -->
            <div class="service-description">
                <h2>About Mentator LLM Service</h2>
                <p>
                    Mentator LLM Service is a specialized local LLM inference service that <strong>guarantees JSON-formatted responses</strong>
                    using grammar-guided generation (GBNF). Built on top of llama.cpp, it enables you to extract structured data
                    from unstructured text with type-safe, schema-validated outputs.
                </p>

                <h3>Key Features</h3>
                <ul>
                    <li><strong>Guaranteed JSON Schema compliance</strong> - responses always match your defined structure</li>
                    <li><strong>Local inference</strong> - full privacy and control over your data</li>
                    <li><strong>GGUF model support</strong> - use quantized models for efficient processing</li>
                    <li><strong>Simple API</strong> - easy integration with REST endpoints</li>
                </ul>

                <h3>Getting Started</h3>
                <p>
                    The service comes with a pre-installed <strong>qwen2.5-0.5b-instruct-q8_0.gguf</strong> model,
                    ready to use out of the box for demonstrating basic capabilities. For production use and better quality results,
                    we recommend downloading more powerful models from
                    <a href="https://huggingface.co/models?library=gguf" target="_blank" rel="noopener">Hugging Face</a>
                    (such as <a href="https://huggingface.co/Qwen/Qwen2.5-7B-Instruct-GGUF" target="_blank" rel="noopener">Qwen2.5-7B-Instruct</a>
                    or <a href="https://huggingface.co/bartowski/Meta-Llama-3.1-8B-Instruct-GGUF" target="_blank" rel="noopener">Llama-3.1-8B-Instruct</a>)
                    and placing them in the configured models directory.
                </p>

                <h3>Usage Examples</h3>
                <p>Let's extract structured data from a story about people:</p>

                <div class="example-story">
                    <strong>Story:</strong><br>
                    I am Bob, I am 9 years old and I live on Sunny Street. My friend Diana lives across from me, she is 8 years old
                    and does gymnastics. A little further away lives my friend John, he is a year older than me. We like to play tennis
                    with him. We ask Mr. Smith to judge our game. He is a former tennis referee. And although he is already 92 years old,
                    he still loves his former job and is happy to help us.
                </div>

                <div class="example-section">
                    <h4>Example 1: Using the Chat Interface</h4>
                    <ol>
                        <li>Go to the <a href="/chat">/chat</a> page</li>
                        <li>Select your model from the dropdown</li>
                        <li>Paste the story above into the "User Prompt" field</li>
                        <li>Add the following text to the beginning of the field <em>"Get all people (name, age, etc.) from this text:"</em></li>
                        <li>Click button "FORMAT" -> enable "use grammar" and paste:
<pre>{
  "type": "array",
  "items": {
    "type": "object",
    "properties": {
      "name": { "type": "string" },
      "age": { "type": "integer" },
      "sex": { "type": "string", "enum": ["male", "female"] },
      "hobby": { "type": "string" }
    },
    "required": ["name", "age", "sex"]
  }
}</pre>
                        </li>
                        <li>Close modal window (button "OK")</li>
                        <li>Click button "OPTIONS" -> click button "SET EXAMPLE FOR JSON" -> close modal window (button "OK")</li>
                        <li>Click "Send" and receive a <strong>guaranteed valid JSON array</strong> of people!</li>
                    </ol>
                </div>

                <div class="example-section">
                    <h4>Example 2: Using the API (POST /prompt)</h4>
                    <p>Send a POST request to <code>/prompt</code>:</p>
<pre>curl -X POST http://127.0.0.1:19777/prompt \
  -H "Content-Type: application/json" \
  -d '{
    "model": "qwen2.5-0.5b-instruct-q8_0.gguf",
    "message": {
      "user": "Get all peoples (name, age, ext) from this text: \nI am Bob, I am 9 years old and I live on Sunny Street. \nMy friend Diana lives across from me, she is 8 years old and does gymnastics. \nA little further away lives my friend John, he is a year older than me. \nWe like to play tennis with him. \nWe ask Mr. Smith to judge our game. \nHe is a former tennis referee. And although he is already 92 years old, he still loves his former job and is happy to help us. "
    },
    "durationMsec": 3600000,
    "options": {
      "temperature": 0.0,
      "topP": 0.1,
      "topK": 10,
      "minP": 0.0,
      "maxTokens": 4096,
      "repeatPenalty": 1.0,
      "repeatPenaltyNum": 0,
      "presencePenalty": 0.0,
      "frequencyPenalty": 0.0,
      "mirostat": 0,
      "mirostatTau": 5.0,
      "mirostatEta": 0.1,
      "penalizeNewline": false,
      "stopSequences": [],
      "trimWhitespace": true,
      "tokenBias": {},
      "evaluationPriority": 5,
      "contextShiftSize": 0,
      "disableContextShift": false
    },
    "format": {
      "useGrammar": true,
      "jsonSchema": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "name": { "type": "string" },
            "age": { "type": "integer" },
            "sex": { "type": "string", "enum": ["male", "female"] },
            "hobby": { "type": "string" }
          },
          "required": ["name", "age", "sex"]
        }
      }
    }
  }'
</pre>
                    <p>
                        The response will contain <code>result.data</code> with a <strong>validated JSON array</strong>
                        matching your schema - no parsing errors, no invalid formats!
                    </p>
                    <p><strong>Expected result.data:</strong></p>
<pre>[
  {
    "name": "Bob",
    "age": 9,
    "sex": "male",
    "hobby": "tennis"
  },
  {
    "name": "Diana",
    "age": 8,
    "sex": "female",
    "hobby": "gymnastics"
  },
  {
    "name": "John",
    "age": 9,
    "sex": "male",
    "hobby": "tennis"
  },
  {
    "name": "Mr. Smith",
    "age": 92,
    "sex": "male",
    "hobby": "tennis referee"
  }
]</pre>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/lib/vue.global.prod.js"></script>
    <script>
        const { createApp } = Vue

        createApp({
            data() {
                return {
                    version: '0.0.0'
                }
            },
            mounted() {
                fetch('/state/version')
                    .then(res => res.json())
                    .then(data => {
                        this.version = data.version
                    })
                    .catch(err => {
                        console.error('Failed to load version:', err)
                    })
            }
        }).mount('#app')
    </script>
</body>
</html>
